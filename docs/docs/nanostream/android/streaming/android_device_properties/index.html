<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>nanostream/android/streaming/android_device_properties · nanocosmos Documentation</title><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="generator" content="Docusaurus"/><meta name="description" content="## DevicesProperties"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="nanostream/android/streaming/android_device_properties · nanocosmos Documentation"/><meta property="og:type" content="website"/><meta property="og:url" content="https://docs.nanocosmos.de/"/><meta property="og:description" content="## DevicesProperties"/><meta property="og:image" content="https://docs.nanocosmos.de/img/docusaurus.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://docs.nanocosmos.de/img/docusaurus.png"/><link rel="shortcut icon" href="/img/favicon_nano.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typesense-docsearch.js@latest/dist/cdn/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-552140-1', 'auto');
              ga('send', 'pageview');
            </script><link rel="stylesheet" href="/css/copy-button.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/js/copy-button.js"></script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/nanocosmos_header_logo.png" alt="nanocosmos Documentation"/><h2 class="headerTitleWithLogo">nanocosmos Documentation</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/docs/cloud/cloud_overview" target="_self">nanoStream Cloud</a></li><li class=""><a href="/docs/nanoplayer/nanoplayer_introduction" target="_self">H5Live Player</a></li><li class=""><a href="/docs/webrtc/nanostream_webrtc_introduction" target="_self">nanoStream Webcaster</a></li><li class=""><a href="/docs/nanomeet/introduction" target="_self">nanoMeet</a></li><li class=""><a href="/docs/nanostream/nanostream" target="_self">nanoStream Apps and SDKs</a></li><li class=""><a href="/docs/samples/samples" target="_self">Samples</a></li><li class=""><a href="/docs/faq/faq_streaming" target="_self">FAQ</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/nanocosmos/docs/tree/master/docs/nanostream/android/streaming/android_device_properties.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">nanostream/android/streaming/android_device_properties</h1></header><article><div><span><h2><a class="anchor" aria-hidden="true" id="devicesproperties"></a><a href="#devicesproperties" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>DevicesProperties</h2>
<p>Before Android 4.3 there was no obligation for Android hardware manufacturers to pass the video related parts of the CTS (Compatibility Test Suite).
Therefore some Android 4.1 and 4.2 Devices show non standard behaviour in regard to color format definitions and representation of video frames in memory.
This could lead to issues in the video stream like switched red and blue colors, dislocated color components or a green bar at the bottom of the video frame.
nanoStream Android now provides the functionality to detect and compensate common issues related to this.</p>
<h3><a class="anchor" aria-hidden="true" id="description"></a><a href="#description" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Description</h3>
<p>nanoStream.getDeviceProperties() is a static function that is running a test on the device hardware to detect non standard behaviour and returning a DeviceProperties object containing the result.
DeviceProperties.getFlags() is returning the test result as an integer value that can be stored in the application preferences, to avoid running the device test on every app start.
The DeviceProperties can be applied to a new nanoStream instance by calling nanoStream.setDeviceProperties(DeviceProperties).
We recommend to call getDeviceProperties() in a background thread during the first app start on a pre 4.3 device, because the call is blocking and might last up to 5 seconds on older/weaker devices.
We also recommend to store the OS version in the preferences, to be able to detect OS updates and to eventually rerun the device test or stop setting the DeviceProperties if the new OS is 4.3 or higher.</p>
<h3><a class="anchor" aria-hidden="true" id="implementation-example"></a><a href="#implementation-example" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Implementation Example</h3>
<pre><code class="hljs css language-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">App</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Application</span>
</span>{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> DeviceProperties deviceProp = <span class="hljs-keyword">null</span>;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onCreate</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">super</span>.onCreate();

        Thread chkThread = <span class="hljs-keyword">new</span> Thread(<span class="hljs-keyword">new</span> Runnable()
        {
            <span class="hljs-meta">@Override</span>
            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span>
            </span>{
                <span class="hljs-keyword">try</span>
                {
                    SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(getApplicationContext());
                    <span class="hljs-keyword">int</span> curApiVer = android.os.Build.VERSION.SDK_INT;
                    <span class="hljs-keyword">int</span> curAppVer = getPackageManager().getPackageInfo(getPackageName(), <span class="hljs-number">0</span>).versionCode;
                    <span class="hljs-keyword">int</span> curEncVer = DeviceProperties.VERSION;

                    <span class="hljs-keyword">int</span> oldApiVer = prefs.getInt(<span class="hljs-string">"Pref_Android_API"</span>, <span class="hljs-number">0</span>);
                    <span class="hljs-keyword">int</span> oldAppVer = prefs.getInt(<span class="hljs-string">"Pref_App_Version"</span>, <span class="hljs-number">0</span>);
                    <span class="hljs-keyword">int</span> oldChkVer = prefs.getInt(<span class="hljs-string">"Pref_Check_Version"</span>, <span class="hljs-number">0</span>);
                    <span class="hljs-keyword">int</span> oldChkResult = prefs.getInt(<span class="hljs-string">"Pref_Check_Result"</span>, -<span class="hljs-number">1</span>);

                    <span class="hljs-keyword">if</span> (((oldApiVer * oldAppVer * oldApiVer) == <span class="hljs-number">0</span>)
                    || (oldApiVer &lt; curApiVer)
                    || (oldAppVer &lt; curAppVer)
                    || (oldChkVer &lt; curEncVer)
                    || oldChkResult &lt; <span class="hljs-number">0</span>)
                    {

                        Editor edit = prefs.edit();
                        edit.putInt(<span class="hljs-string">"Pref_Android_API"</span>, curApiVer);
                        edit.putInt(<span class="hljs-string">"Pref_App_Version"</span>, curAppVer);

                        <span class="hljs-comment">/* Run  device check */</span>
                        <span class="hljs-keyword">try</span>
                        {
                            deviceProp = nanoStream.getDeviceProperties();

                            edit.putInt(<span class="hljs-string">"Pref_Check_Result"</span>, deviceProp.getFlags());
                            edit.putInt(<span class="hljs-string">"Pref_Check_Version"</span>, deviceProp.getVersion());
                            edit.commit();
                        }
                        <span class="hljs-keyword">catch</span> (RuntimeException e)
                        {
                            Log.d(<span class="hljs-string">"Device Check failed"</span>, e.toString());
                            edit.putInt(<span class="hljs-string">"Pref_Check_Result"</span>, -<span class="hljs-number">1</span>);
                            edit.putInt(<span class="hljs-string">"Pref_Check_Version"</span>, <span class="hljs-number">0</span>);
                            edit.commit();
                        }

                    }
                    <span class="hljs-keyword">else</span>
                    {
                        deviceProp = <span class="hljs-keyword">new</span> DeviceProperties(oldChkResult);
                    }

                    Log.d(<span class="hljs-string">"Device Properties: "</span>, deviceProp.toString());
                }
                <span class="hljs-keyword">catch</span> (Exception e)
                {
                    Log.d(<span class="hljs-keyword">this</span>.getClass().getName(), <span class="hljs-string">"Device Check Runnable"</span>);
                    e.printStackTrace();
                }
            }
        });

        <span class="hljs-keyword">if</span> (android.os.Build.VERSION.SDK_INT &lt; <span class="hljs-number">18</span>)
        {
            chkThread.start();
        }

        ...
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> DeviceProperties <span class="hljs-title">getDeviceProperties</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">return</span> deviceProp;
    }
}
</code></pre>
<pre><code class="hljs css language-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Activity</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">NanostreamEventListener</span>
</span>{
    ...
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span>
    </span>{
        <span class="hljs-keyword">try</span>
        {
            nanoStreamSettings nss = <span class="hljs-keyword">new</span> nanoStreamSettings();

            streamLib = <span class="hljs-keyword">new</span> nanoStream(nss);

            DeviceProperties deviceProperties = App.getDeviceProperties();

            <span class="hljs-keyword">if</span>(<span class="hljs-keyword">null</span> != streamLib &amp;&amp; <span class="hljs-keyword">null</span> != deviceProperties)
            {
                streamLib.setDeviceProperties(deviceProperties);
            }
        }
        <span class="hljs-keyword">catch</span>(NanostreamException en)
        {
            Toast.makeText(getApplicationContext(), en.toString(), Toast.LENGTH_LONG).show();
        }
    }
    ...
}
}
</code></pre>
</span></div></article></div><div class="docLastUpdate"><em>Last updated on 5/11/2023</em></div><div class="docs-prevnext"></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#devicesproperties">DevicesProperties</a><ul class="toc-headings"><li><a href="#description">Description</a></li><li><a href="#implementation-example">Implementation Example</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><div><h5>Contact</h5><a href="https://www.nanocosmos.de/">Homepage</a><a href="https://www.nanocosmos.de/contact">Contact</a><a href="https://www.nanocosmos.de/support">Support</a><a href="https://www.nanocosmos.de/terms">Legal Terms</a></div><div><h5>Products</h5><a href="https://www.nanocosmos.de/cloud">Nanostream Cloud with Bintu.Live</a><a href="https://www.nanocosmos.de/h5live">H5Live Low Latency HTML5-Player</a><a href="https://www.nanocosmos.de/webrtc">nanoStream Webcaster</a><a href="https://www.nanocosmos.de/#nanostream">Nanostream Apps and SDK</a></div><div><h5>More</h5><a href="https://www.nanocosmos.de/blog/">Blog</a><a href="https://twitter.com/nanovideo">Twitter</a><a href="https://www.facebook.com/nanocosmos.net/">Facebook</a><a href="https://www.linkedin.com/company/nanocosmos-gmbh">LinkedIn</a><a href="https://github.com/nanocosmos/docs">GitHub</a><a class="github-button" href="https://github.com/nanocosmos/docs" data-icon="octicon-star" data-count-href="/nanocosmos/docs/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><a href="https://nanocosmos.de/" target="_blank" rel="noreferrer noopener" class="fbOpenSource"><img src="/img/footer_logo.png" alt="nanocosmos GmbH" width="170" height="45"/></a><section class="copyright">Copyright © 2023 nanocosmos GmbH - doc version Thu May 11 2023 08:26:25 GMT+0000 (Coordinated Universal Time)</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/typesense-docsearch.js@latest/dist/cdn/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                inputSelector: '#search_input_react',
                typesenseServerConfig: {"nodes":[{"host":"typesense.nanostream.cloud","port":"443","protocol":"https"}],"apiKey":"VXsRNvH2cHHs5uVOk74gX8jDtWTTVKsV"},
                typesenseCollectionName: "nanocosmos",
                typesenseSearchParams: {"per_page":20},
                debug: true,
              });
              </script></body></html>